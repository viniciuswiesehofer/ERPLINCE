var iconizeAdminDialog;(function(e){"use strict";var t,n,r,i,s={},o=[],u=[],a=[],f=[],l=[],c=[],h=[],p=[],d=[],v=[],m=["iconized","iconized-stack","iconized-stack-base"],g="hover-color-change",y="",b="",w="",E="",S="",x="",T="",N="",C="",k="",L="",A="",O="",M="",_="",D="",P="",H="",B="",j="",F="",I="",q="";iconizeAdminDialog={init:function(){s.dialog=e("#iconize-admin-modal");s.submit=e("#iconize-admin-update");s.remove=e("#iconize-admin-remove");s.set=e("#admin-icon-set");s.name=e("#admin-icon-name");s.effect=e("#admin-icon-effect");s.transform=e("#admin-icon-transform");s.animate=e("#admin-icon-animate");s.hover=e("#admin-icon-hover");s.color=e("#admin-icon-color");s.hovercolor=e("#admin-icon-color-hover");s.size=e("#admin-icon-size");s.align=e("#admin-icon-align");s.custom=e("#admin-icon-custom-classes");n=e("#iconize-admin-icons");r=e("#iconize-admin-title");i=e("#admin-color-hover-checkbox");f=iconizeAdminDialog.getSelectOptions(s.set);p=iconizeAdminDialog.getSelectOptions(s.transform);d=iconizeAdminDialog.getSelectOptions(s.animate);v=iconizeAdminDialog.getSelectOptions(s.hover);c=iconizeAdminDialog.getSelectOptions(s.size);h=iconizeAdminDialog.getSelectOptions(s.align);a=iconizeAdminDialog.getSelectOptions(s.effect);if(iconizeDialogParams.icons){for(var R=0;R<f.length;R++){var U=f[R],z=iconizeDialogParams.icons[U],W=e('<ul id="'+U+'-icons-list">').addClass("icons-list");n.append(W);e.merge(u,z);for(var X=0;X<z.length;X++){var V=z[X],J="glyph-"+V,K="";K='<li class="icons-list-item">';K+='<a href="#" class="icons-list-icon" title="'+V+'" data-set="'+U+'">';K+='<span class="iconized '+U+" "+J+'"></span>';K+="</a>";K+="</li>";W.append(K);o.push({label:V,set:U});l.push(J)}}}m.push(g);e.merge(m,l);e.merge(m,f);e.merge(m,p);e.merge(m,d);e.merge(m,v);e.merge(m,c);e.merge(m,h);s.color.wpColorPicker({change:function(){iconizeAdminDialog.setColor(e(this).wpColorPicker("color"));i.removeClass("hidden")},clear:function(){iconizeAdminDialog.setColor("");i.addClass("hidden");s.hovercolor.prop("checked",false)}});s.name.iconizeautocomplete({appendTo:s.dialog,source:o,minLength:1,change:function(t,r){if(null===r.item){var i=n.find(".selected-icon"),o=i.attr("title"),u=i.data("set");if(i.length){e(this).val(o);s.set.val(u)}else{e(this).val("");s.set.val(f[0])}}},select:function(e,t){n.find(".icons-list-icon.selected-icon").removeClass("selected-icon");s.set.val(t.item.set);n.find(".icons-list").hide();n.find("#"+t.item.set+"-icons-list").show();n.find("."+t.item.set+".glyph-"+t.item.value).parent().addClass("selected-icon");s.name.val(t.item.value);iconizeAdminDialog.scrollToIcon()}}).bind("focus",function(){e(this).iconizeautocomplete("search")});e("#iconize-admin-modal .icons-list-icon").click(function(t){t.preventDefault();var r=e(this);if(false===r.hasClass("selected-icon")){n.find(".icons-list-icon.selected-icon").removeClass("selected-icon");r.addClass("selected-icon");s.name.val(r.attr("title"))}});s.custom.tagit({autocomplete:{disabled:true},preprocessTag:function(e){if(!e){return""}var t=e.replace(/^[^-_a-zA-Z]+/,"").replace(/^-(?:[-0-9]+)/,"-");var n=t&&t.replace(/[^-_a-zA-Z0-9]+/g,"-");return n},afterTagAdded:function(t,n){if(e.inArray(n.tagLabel,m)!==-1){alert(iconizeDialogParams.l10n.reserved_class);s.custom.tagit("removeTag",n.tag)}}});s.set.change(function(){var t=e(this).val(),r="#"+t+"-icons-list";n.find(".icons-list").hide();n.find(r).show();n.scrollTop(0)});s.submit.click(function(e){e.preventDefault();iconizeAdminDialog.update()});s.remove.click(function(e){e.preventDefault();iconizeAdminDialog.remove()});e(document).on("click",".preview-icon",function(n){n.preventDefault();t=e(this);y=t.parent().next().children(".iconize-input-name").attr("id");b=t.parent().next().children(".iconize-input-set").attr("id");w=t.parent().next().children(".iconize-input-transform").attr("id");E=t.parent().next().children(".iconize-input-color").attr("id");S=t.parent().next().children(".iconize-input-size").attr("id");x=t.parent().next().children(".iconize-input-align").attr("id");T=t.parent().next().children(".iconize-input-custom-classes").attr("id");N="#"+y;C="#"+b;k="#"+w;L="#"+E;A="#"+S;O="#"+x;M="#"+T;_=e(N).val();D=e(C).val();P=e(k).val();H=e(L).val();B=e(A).val();j=e(O).val();F=e(M).val();I="."+D+"."+_;iconizeAdminDialog.show()});iconizeAdminDialog.updatePreviewIconColors();e(document).on("ajaxStop",function(){iconizeAdminDialog.updatePreviewIconColors()});e("form#addtag input#submit").click(function(t){var n=e(this).parents("form");if(validateForm(n)){q="clicked"}});e(document).on("ajaxComplete",function(){if(e("body").hasClass("edit-tags-php")){if("clicked"===q){iconizeAdminDialog.remove()}q=""}});s.dialog.on("shown.wpbs.modal",function(){iconizeAdminDialog.scrollToIcon(true)});s.dialog.on("hidden.wpbs.modal",iconizeAdminDialog.closed)},show:function(){var t,o,u=[],c=false;if(!l.length){alert(iconizeDialogParams.l10n.no_icons_defined);return}n.addClass("loading-overlay");iconizeAdminDialog.clearColorPicker();iconizeAdminDialog.clearCustomClasses();if(""!==_&&""!==D){s.remove.show();if(e.inArray(_,l)!==-1&&e.inArray(D,f)!==-1){r.text(iconizeDialogParams.l10n.edit);s.submit.text(iconizeDialogParams.l10n.update);s.set.val(D);n.find(".icons-list").hide();n.find("#"+D+"-icons-list").show();n.find(".icons-list-icon.selected-icon").removeClass("selected-icon");n.find(I).parent().addClass("selected-icon");s.name.val(_.replace("glyph-",""));if(!P){s.effect.val(a[0]);s.transform.val("");s.animate.val("");s.hover.val("")}else if(e.inArray(P,p)!==-1){s.effect.val("transform");s.transform.val(P)}else if(e.inArray(P,d)!==-1){s.effect.val("animate");s.animate.val(P)}else if(e.inArray(P,v)!==-1){s.effect.val("hover");s.hover.val(P)}iconizeAdminDialog.showChildOptions(s.effect);s.color.val(H);s.color.wpColorPicker("color",H);s.size.val(B);s.align.val(j);u=F.split(",");if(H){if(u.length){o=e.inArray(g,u);if(o!==-1){c=true;u.splice(o,1)}}i.removeClass("hidden")}else{i.addClass("hidden")}s.hovercolor.prop("checked",c);for(t=0;t<u.length;t++){s.custom.tagit("createTag",u[t])}}else{alert(iconizeDialogParams.l10n.no_icon_found_admin);iconizeAdminDialog.setDefaultValues()}}else{s.remove.hide();iconizeAdminDialog.setDefaultValues()}s.dialog.wpbsmodal("show")},close:function(){s.dialog.wpbsmodal("hide");if(e("body").hasClass("wp-customizer")){var n=t.parent().parent().parent().parent().find("input.widget-control-save");n.click()}},closed:function(){t.focus()},update:function(){var n="",r="",i="",o="",u="",a="",f="",l="",c="";if(!s.name.val()){alert(iconizeDialogParams.l10n.no_icon_selected)}else{n=s.set.val();r="glyph-"+s.name.val();i=s.effect.val();if("transform"===i){o=s.transform.val()}else if("animate"===i){o=s.animate.val()}else if("hover"===i){o=s.hover.val()}u=s.color.val();a=s.hovercolor.prop("checked");f=s.size.val();l=s.align.val();c=s.custom.tagit("assignedTags");c=c.toString();if(a){if(c){c+=","+g}else{c=g}}e(N).val(r);e(C).val(n);e(k).val(o);e(L).val(u);e(A).val(f);e(O).val(l);e(M).val(c);t.children().removeClass().addClass("iconized").addClass(n).addClass(r).addClass(o).css("color",u);if(a){t.children().addClass(g)}iconizeAdminDialog.close()}},remove:function(){s.set.val("");s.name.val("");s.effect.val(a[0]);s.transform.val("");s.animate.val("");s.hover.val("");s.color.val("");s.hovercolor.prop("checked",false);s.size.val("");s.align.val("");iconizeAdminDialog.clearColorPicker();iconizeAdminDialog.clearCustomClasses();e(N).val("");e(C).val("");e(k).val("");e(L).val("");e(A).val("");e(O).val("");e(M).val("");t.children().removeClass().css("color","");iconizeAdminDialog.close()},setDefaultValues:function(){r.text(iconizeDialogParams.l10n.add);s.submit.text(iconizeDialogParams.l10n.add);s.set.val(f[0]);n.find(".icons-list").hide();n.find("#"+f[0]+"-icons-list").show();s.name.val("");n.find(".icons-list-icon.selected-icon").removeClass("selected-icon");s.effect.val(a[0]);s.transform.val("");s.animate.val("");s.hover.val("");iconizeAdminDialog.showChildOptions(s.effect);s.color.val("");s.hovercolor.prop("checked",false);i.addClass("hidden");s.size.val("");s.align.val("")},updatePreviewIconColors:function(){e(".preview-icon").each(function(){var t=e(this),n="",r="",i=[];n=t.parent().next().children(".iconize-input-color").val();r=t.parent().next().children(".iconize-input-custom-classes").val();if(""!==n){t.children().css("color",n);i=r.split(",");if(i.length&&e.inArray(g,i)!==-1){t.children().addClass(g)}}})},setColor:function(e){s.color.val(e)},clearColorPicker:function(){s.color.wpColorPicker("color","");e("#iconize-admin-modal .wp-color-result").removeAttr("style")},clearCustomClasses:function(){s.custom.tagit("removeAll")},scrollToIcon:function(e){var t=e||false,r="",i=0;r=s.dialog.find(".selected-icon");if(r.length){i=r.position().top-n.position().top+n.scrollTop()-92}if(true===t){n.animate({scrollTop:i},"500","swing",function(){n.removeClass("loading-overlay")})}else{n.scrollTop(i)}},getSelectOptions:function(t){var n=[];t.find("option").each(function(){var t=e(this).val();n.push(t)});return n},showChildOptions:function(t){var n=t,r=n.val(),i=n.attr("id"),s=".mother-opt-"+i,o=".mother-val-"+r;e(s).addClass("hidden");e(s+o).removeClass("hidden")}};e(document).ready(iconizeAdminDialog.init)})(jQuery);